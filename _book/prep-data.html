<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Ocean Health Index Toolbox Training</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is the official Ocean Health Index Toolbox training.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Ocean Health Index Toolbox Training" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the official Ocean Health Index Toolbox training." />
  <meta name="github-repo" content="ohi-science/ohi-trainings" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Ocean Health Index Toolbox Training" />
  
  <meta name="twitter:description" content="This is the official Ocean Health Index Toolbox training." />
  

<meta name="author" content="Ocean Health Index Team">


<meta name="date" content="2017-04-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="toolbox.html">
<link rel="next" href="calcs-basic.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Home</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="datascience.html"><a href="datascience.html"><i class="fa fa-check"></i><b>3</b> Data science workflow</a></li>
<li class="chapter" data-level="4" data-path="toolbox.html"><a href="toolbox.html"><i class="fa fa-check"></i><b>4</b> Toolbox Ecosystem</a></li>
<li class="chapter" data-level="5" data-path="prep-data.html"><a href="prep-data.html"><i class="fa fa-check"></i><b>5</b> Preparing data: Basic</a><ul>
<li class="chapter" data-level="5.1" data-path="prep-data.html"><a href="prep-data.html#overview"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="prep-data.html"><a href="prep-data.html#data-formatting-requirements"><i class="fa fa-check"></i><b>5.2</b> Data Formatting requirements</a></li>
<li class="chapter" data-level="5.3" data-path="prep-data.html"><a href="prep-data.html#data-wrangling"><i class="fa fa-check"></i><b>5.3</b> Data Wrangling</a></li>
<li class="chapter" data-level="5.4" data-path="prep-data.html"><a href="prep-data.html#save-and-register-data-layers"><i class="fa fa-check"></i><b>5.4</b> Save and Register data layers</a></li>
<li class="chapter" data-level="5.5" data-path="prep-data.html"><a href="prep-data.html#register-data-layers-in-layers.csv"><i class="fa fa-check"></i><b>5.5</b> Register data layers in <code>layers.csv</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="calcs-basic.html"><a href="calcs-basic.html"><i class="fa fa-check"></i><b>6</b> Calculations: basic workflow</a></li>
<li class="chapter" data-level="7" data-path="calcs-advanced.html"><a href="calcs-advanced.html"><i class="fa fa-check"></i><b>7</b> Calculations: advanced workflow</a></li>
<li class="chapter" data-level="8" data-path="updating-your-website.html"><a href="updating-your-website.html"><i class="fa fa-check"></i><b>8</b> Updating your website</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ocean Health Index Toolbox Training</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="prep-data" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Preparing data: Basic</h1>
<div id="overview" class="section level2">
<h2><span class="header-section-number">5.1</span> Overview</h2>
<p>Data prep often takes the biggest chunk of time in an OHI assessment, more than the final calculation of the OHI scores itself! The Prep Repo aims to help you wade through this mundane yet important first step of the assessment. Treat the prep document as your notebook, calculator, and presentation of your work. You can explore raw data, see whether it fits within the bounds of your spatial boundaries and whether it makes sense to include it in your final calculations. If it does, you can format it further and save it as data layers. The process of data exploration is recorded and can be easily shared with anyone.</p>
<p><strong>Why prep here?</strong> For transparenty and reproducibility. If someone wants to see where your data comes from, how you have processed the data, and what’s the rationale for including or excluding certain data, they can find the answers here. It increases the credibility and reproducibility of your assessment. Prepping in this system will be helpful to yourself. In a few months, or years, you can visit this page and remember what you had done. It also makes your technical team more stable. If there are personale changes, your team memory is preserved. It’s easy for any new memeber to pick up where it was left when your data prepation has been documented clearly and kept in one place.</p>
<p><strong>Why Rmarkdown?</strong> Rmarkdown produces a report with your comments, R code, and figures/tables embedded in it. It can be rendered as a beautiful HTML webpage to easily communicate with other people. We highly recommend it to anyone who is interested in open science, especially OHI+ users. However, if you prefer to use an r script with comments tucked into it, see <code>example_prep_non_spatial.r</code> for the same example.</p>
<p><strong>What will you learn in this chapter?</strong></p>
<p>We will go through:</p>
<ul>
<li>formatting requirements of each data layer</li>
<li>a hands-on tutorial in which you can use sample data to format and save</li>
<li>how to register each data layer</li>
</ul>
</div>
<div id="data-formatting-requirements" class="section level2">
<h2><span class="header-section-number">5.2</span> Data Formatting requirements</h2>
<p>The OHI Toolbox expects each data layer to be</p>
<ul>
<li>in its own <em>.csv</em> file</li>
<li>with data available for every region within the study area</li>
<li>with data organized in ‘long’ format (as few columns as possible)</li>
<li>with a unique region identifier (<em>rgn_id</em>) associated with a single score or value.</li>
</ul>
<p>As you discover and gather potential data sources, they can be prepared and explored in the Starter Repo. Data preparation is done in <strong>R</strong> using input data stored in <strong><em>.csv files</em></strong> (or ‘comma-separated value’). These files can be opened as a spreadsheet using Microsoft Excel or similar programs. Each data layer (data input) has its own <em>.csv</em> file, which is combined with others within the Toolbox for the model calculations. These data layers are used for calculating goal scores, meaning that they are inputs for status, trend, pressures, and resilience. The global analysis included over 100 data layer files, and there will probably be as many in your own assessments. This section describes and provides examples of how to format the data layers for the Toolbox.</p>
<blockquote>
<p>It is highly recommended that layer preparation occurs in your repository’s <code>prep</code> folder as much as possible, as it will also be archived by GitHub for future reference. The folder is divided into sub-folders for each goal and sub-goal, where you will upload the raw data and manipulate the data in <code>data_prep.R</code> scripts.</p>
</blockquote>
<p><strong>OHI goal scores are calculated at the scale of the reporting unit</strong>, which is called a ‘<strong>region</strong>’ and then combined using an area-weighted average to produce the score for the overall area assessed, called a ‘<strong>study area</strong>’. In order to calculate trend, input data should be available as a time series for at least 5 recent years (and the longer the time series the better, as this can be used in setting temporal reference points).</p>
<blockquote>
<p>Finalized data layers have at least two columns: the <code>rgn_id</code> column and a column with data that is best identified by its units (eg. <em>km2</em> or <em>score</em>). There often may be a <code>year</code> column or a <code>category</code> column (for natural product categories or habitat types).</p>
</blockquote>
<p>The example below shows information for a study area with 4 regions. There are two different (and separate) data layer files: tourism count (<code>tr_total.csv</code>) and natural products harvested, in metric tonnes (<code>np_harvest_tonnes.csv</code>). Each file has data for four regions (1-4) in different years, and the second has an additional ‘categories’ column for the different types of natural products that were harvested. In this example, the two data layers are appropriate for status calculations with the Toolbox because:</p>
<ol style="list-style-type: decimal">
<li>At least five years of data are available,</li>
<li>There are no data gaps</li>
<li>Data are presented in ‘long’ or ‘narrow’ format (not ‘wide’ format – see “<strong>Long Formatting</strong>”&quot; section).</li>
</ol>
<p>_When data gaps, temoral or spatial, are inevitable, various gap-filling techniques can be used. We won’t go through the details here. For more information and examples, visit <a href="http://ohi-science.org/manual/#gapfilling">OHI Manual</a>.</p>
</div>
<div id="data-wrangling" class="section level2">
<h2><span class="header-section-number">5.3</span> Data Wrangling</h2>
<p>How do we get from raw data to a data layer? Here is an <a href="https://github.com/OHI-Science/bhi/blob/draft/baltic2015/prep/CW/eutrophication/eutrophication_prep.md">example</a> of data prep document. Let’s give it a try to make one just like this.</p>
<p>Go to your <code>toolbox-demo</code> repository, open <code>prep/CW/CW_data_prep.Rmd</code>, and follow the tutorials from there.</p>
</div>
<div id="save-and-register-data-layers" class="section level2">
<h2><span class="header-section-number">5.4</span> Save and Register data layers</h2>
<p>Before processed data can be used by the Toolbox for calculations, they need to be saved and registered here:</p>
<div class="figure">
<img src="https://docs.google.com/drawings/d/1IwHf8pMBlpzOIYKL0hoEF5rETGA765Qtwkz7es7B3Rg/pub?h=500" />

</div>
<p>You have in the data prep script saved the data layer in <code>layers</code> folder, now let’s register it so that OHI Toolbox knows where to look for data when you calculate scores.</p>
</div>
<div id="register-data-layers-in-layers.csv" class="section level2">
<h2><span class="header-section-number">5.5</span> Register data layers in <code>layers.csv</code></h2>
<p>Data layers are registered in <code>layers.csv</code>.</p>
<div class="figure">
<img src="https://docs.google.com/drawings/d/1juueRiA0gevOoHH_8owzLNanyQ-H1mAOEl7L_l5YSJ0/pub?h=600" />

</div>
<p><em>If a layer simply has a new filename, only the <em>filename</em> column needs to be updated.</em></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="toolbox.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="calcs-basic.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
